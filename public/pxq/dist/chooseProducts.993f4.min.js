webpackJsonp([3],{277:function(t,e,o){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i,c,u,d,p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r])}return t},l=function(){function t(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,o,r){return o&&t(e.prototype,o),r&&t(e,r),e}}(),h=o(3),f=r(h),m=o(16),v=(r(m),o(20),o(15),o(11)),y=(o(21),o(26)),S=function(t){function e(){return a(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),l(e,[{key:"shouldComponentUpdate",value:function(t,e){return!(0,v.is)((0,v.fromJS)(this.props),(0,v.fromJS)(t))||!(0,v.is)((0,v.fromJS)(this.state),(0,v.fromJS)(e))}},{key:"render",value:function(){return f.default.createElement("div",null,f.default.createElement("ul",{className:"product_list_ul"},this.props.list.map(function(t,e){return f.default.createElement(b,p({key:e},t,{index:e}))})))}}]),e}(h.Component),b=(c=i=function(t){function e(t,o){a(this,e);var r=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o));return r.state={productCount:r.props.num,chooseState:r.props.chooseState},r.getProductCount=function(t){if(r.state.chooseState){var e=r.state.productCount;"reduce"==t&&e>0?(e-=1,r.setState({productCount:e})):"add"==t&&(e+=1,r.setState({productCount:e})),r.context.recordState(r.props.id,r.state.chooseState,e,r.props.index)}},r.handleChange=function(t){if(r.state.chooseState){var e=t.target.value;e=Number(e.replace(/\D+/gi,"")),r.setState({productCount:e}),r.context.recordState(r.props.id,r.state.chooseState,e,r.props.index)}},r.changeState=function(){var t=!r.state.chooseState;r.setState({chooseState:t}),r.context.recordState(r.props.id,t,r.state.productCount,r.props.index)},r}return s(e,t),l(e,[{key:"shouldComponentUpdate",value:function(t,e){return!(0,v.is)((0,v.fromJS)(this.props),(0,v.fromJS)(t))||!(0,v.is)((0,v.fromJS)(this.state),(0,v.fromJS)(e))}},{key:"render",value:function(){var t=this.props,e=t.productName,o=(t.id,this.state.productCount);return f.default.createElement("li",{className:"chooseProduct_item clear"},f.default.createElement("div",{className:"chooseItem_left ellips left "+(1==this.state.chooseState?"choosed":""),onClick:this.changeState}," ",e),f.default.createElement("div",{className:"chooseItem_right right"},f.default.createElement("button",{disabled:o>0?"":"disabled",className:(o>0?"reduce":"reduce_no")+" button_style ",onClick:this.getProductCount.bind(this,"reduce")}),f.default.createElement("input",{type:"text",className:"product_num",maxLength:"5",value:o,onChange:this.handleChange}),f.default.createElement("button",{className:"add button_style",onClick:this.getProductCount.bind(this,"add")})))}}]),e}(h.Component),i.contextTypes={recordState:f.default.PropTypes.any,store:f.default.PropTypes.any},c),g=(d=u=function(t){function e(t,o){a(this,e);var r=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o));return r.state={productList:[],params:"",shouldUpdata:!1,left:0,num:0,director:-1,requestID:null,clientWidth:0,moving:!1},r.productsState=function(t,e,o,a){r.state.productList[a].chooseState=e,r.state.productList[a].num=o,r.props.saveProductlist(r.state.productList)},r.move=function(){r.state.clientWidth=document.documentElement.clientWidth,r.state.director=r.state.director*-1,cancelAnimationFrame(r.state.requestID),r.getMove(),r.state.moving=!0},r.getMove=function(){r.state.requestID=requestAnimationFrame(function(){r.state.num=4*r.state.director+r.state.num,r.setState({left:r.state.num+"px"}),r.state.num>=r.state.clientWidth-100?r.state.director=r.state.director*-1:r.state.num<=0&&(r.state.director=r.state.director*-1),r.getMove()})},r}return s(e,t),l(e,[{key:"getChildContext",value:function(){return{recordState:this.props.recordState}}},{key:"componentWillReceiveProps",value:function(t){var e=this;if(this.state.shouldUpdata=!1,this.props!==t){var o=t.state.data;if(t.producRecord.productList&&0==this.state.productList.length)this.state.shouldUpdata=!0,this.state.productList=t.producRecord.productList;else if(o&&o.data&&o.data.data&&0==this.state.productList.length){this.state.shouldUpdata=!0;var r=o.data.data;this.props.newProductData(r),r.forEach(function(t,o){e.state.productList[o]={},e.state.productList[o].productName=t.product_name,e.state.productList[o].chooseState=!1,e.state.productList[o].id=t.product_id,e.state.productList[o].num=1})}if(t.producRecord.id){var a=t.producRecord;this.productsState(a.id,a.chooseState,a.num,a.index)}}}},{key:"componentWillUpdate",value:function(t,e){}},{key:"componentWillMount",value:function(){this.state.params=this.props.location.search}},{key:"shouldComponentUpdate",value:function(t,e){return!(0,v.is)((0,v.fromJS)(this.props),(0,v.fromJS)(t))||!(0,v.is)((0,v.fromJS)(this.state),(0,v.fromJS)(e))&&(this.state.shouldUpdata||this.state.moving)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.state.requestID)}},{key:"render",value:function(){return{position:"fixed",backgroundColor:"red",height:"100px",width:"100px",zIndex:99999,left:this.state.left,bottom:"0"},f.default.createElement("div",{className:"component_container"},f.default.createElement(y.Header,{goback:!0,title:"销售商品",save:!0,params:this.state.params}),this.state.productList.length>0?f.default.createElement(S,{list:this.state.productList}):null)}}]),e}(h.Component),u.childContextTypes={recordState:f.default.PropTypes.any},d);e.default=(0,y.template)({id:"chooseProducts",component:g,url:"/shopro/data/products"})}});